{% extends '../base_dashboard.html' %}
{% block title %} Ø§Ù„Ø·Ù„Ø§Ø¨ {% endblock %}
{% block students %}active{% endblock %}
{% block users %}active{% endblock  %}
{% block users_collapse %}show{% endblock %} 
{% block breadcrumbt %}
<li class="breadcrumb-item "><a class="text-light" href="{% url 'main_dashboard' %}">Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</a></li>
<li class="breadcrumb-item active" aria-current="page"><a class="text-primary" href="{% url 'student:student_list' %}">Ø§Ù„Ø·Ù„Ø§Ø¨</a></li>
{% endblock breadcrumbt %}

{% block content %}

<div class="container w-100 my-5 ">
  <!-- Filter Section -->
  <div class="my-3 d-flex justify-content-between align-content-center">
    <div><h3 class="text-primary">Ø§Ù„Ø·Ù„Ø§Ø¨</h3></div>
    <div> 
      <a class="btn btn-primary btn-lg" href="{% url 'student:create-student' %}"> 
        Ø¥Ø¶Ø§ÙØ© Ø·Ø§Ù„Ø¨
      </a> 
    </div>
  </div>

  <!-- Table -->
  <div class="container-fluid table-container p-3">
    <div class="d-flex justify-content-end my-2">
      <div id="preloader" class="spinner-border text-primary" role="status" style="display: none;">
        <span class="visually-hidden">Loading...</span>
      </div>
      <div class="search-container">
        <input 
          type="text" 
          class="search-input" 
          placeholder="Ø¨Ø­Ø«" 
          id="searchInput"
        />
      </div>
    
    </div>

    <div class="table-responsive">
      <table class="table table-hover txt-color align-middle">
        <thead>
          <tr>
            <th scope="col">Ø§Ù„Ø±Ù‚Ù…</th>
            <th scope="col">Ø§Ù„Ø§Ø³Ù…</th>
            <th scope="col">Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ</th>
            <th scope="col">Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡</th>
          </tr>
        </thead>
        <tbody class="bg-transparent">
          {% for student in students %}
          <tr class="txt-color">
            <td>{{ student.id }}</td>
            <td>{{ student.fullName }}</td>
            <td>{{ student.phone }}</td>
            <td class="action-buttons">
              <!-- Ø²Ø± Ø§Ù„ØªØ¹Ø¯ÙŠÙ„ -->
              <button onclick="window.location.href='{% url 'student:update-student' student.id %}'" class="edit">âœï¸</button>
              <!-- Ø²Ø± Ø§Ù„Ø­Ø°Ù -->
              <button type="button" rel="tooltip" class="delete" data-bs-toggle="modal" data-bs-target="#deletestudentModal{{student.id}}">
                ğŸ—‘ï¸
              </button>

              <!-- Delete Modal -->
              <div class="modal fade" id="deletestudentModal{{student.id}}" tabindex="-1" aria-labelledby="deletestudentModalLabel{{student.id}}" aria-hidden="true">
                <div class="modal-dialog" role="document">
                  <div class="modal-content text-dark">
                    <div class="modal-header">
                      <h5 class="modal-title" id="deletestudentModalLabel{{student.id}}">
                        Ø­Ø°Ù {{ student.name }}
                      </h5>
                      <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                      <p>Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ø£Ù†Ùƒ ØªØ±ÙŠØ¯ Ø­Ø°Ù</p>
                      <p>"{{ student.fullName }}"</p>
                    </div>
                    <div class="modal-footer">
                      <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Ø¥Ù„ØºØ§Ø¡</button>
                      <a class="btn btn-danger" href="{% url 'student:delete_student' student.id %}">Ø­Ø°Ù</a>
                    </div>
                  </div>
                </div>
              </div>
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
</div>
<script>
  document.getElementById("searchInput").addEventListener("input", function () {
    const preloader = document.getElementById("preloader");
    const filter = this.value.toLowerCase();
    const table = document.querySelector(".table tbody");
    const rows = table.getElementsByTagName("tr");
  
    preloader.style.display = "block";
  
    setTimeout(() => {
      Array.from(rows).forEach((row) => {
        const cells = row.getElementsByTagName("td");
        const rowText = Array.from(cells)
          .map(cell => cell.textContent.toLowerCase())
          .join(" ");
  
        if (rowText.includes(filter)) {
          row.style.display = "";
        } else {
          row.style.display = "none";
        }
      });
  
      preloader.style.display = "none";
    }, 500);
  });
</script>

{% endblock %}
